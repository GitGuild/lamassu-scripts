DAYS_TO_KEEP=3
DATE=$(date --utc +%F_%H-%M)
BACKUP_DIR=/opt/backups/bitcoind
BACKUP_FILE=$BACKUP_DIR/backup-$DATE.dat

bitcoin-cli backupwallet $BACKUP_FILE
gzip $BACKUP_FILE
find $BACKUP_DIR -maxdepth 1 -mtime +$DAYS_TO_KEEP -exec rm -f '{}' ';'
